<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>飞升放置等级提升时间计算器</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f0f8ff;
      line-height: 1.6;
    }
    input, button, select {
      font-size: 16px;
      padding: 6px 10px;
      margin: 6px 0;
    }
    .result {
      margin-top: 15px;
      font-weight: bold;
    }
    .input-row {
      margin: 10px 0;
    }
    label {
      display: inline-block;
      width: 150px;
    }
    .tea-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    .tea-label {
      width: 150px;
    }
    .tea-options {
      display: flex;
      gap: 10px;
    }
  </style>
</head>
<body>
  <h2>飞升放置等级提升时间计算器</h2>
  
  <div class="input-row">
    <label>选择职业:</label>
    <select id="profession" onchange="updateTeaOptions()">
      <option value="extract">汲取</option>
      <option value="collect">采集</option>
    </select>
  </div>
  
  <div class="input-row">
    <label>当前等级:</label>
    <input id="level" type="number" min="1" max="199" onchange="autoSetTool()" />
  </div>
  
  <div class="input-row">
    <label>当前进度%:</label>
    <input id="progress" type="number" min="0" max="100" value="0" />
  </div>
  
  <div class="input-row">
    <label>选取项目:</label>
    <select id="project">
      <option value="1">1阶段</option>
      <option value="2">2阶段</option>
      <option value="3">3阶段</option>
      <option value="4">4阶段</option>
      <option value="5">5阶段</option>
      <option value="6">6阶段</option>
      <option value="7">7阶段</option>
    </select>
  </div>
  
  <div class="input-row">
    <label>工具:</label>
    <select id="tool">
      <option value="none">无</option>
      <option value="green">青绿</option>
      <option value="emerald">祖母</option>
      <option value="platinum">白金</option>
      <option value="copper">山铜</option>
      <option value="purple">秘紫</option>
      <option value="gold">精金</option>
      <option value="azure">湛蓝</option>
    </select>
  </div>
  
  <div class="input-row">
    <label>强化等级:</label>
    <input id="enhancement" type="number" min="0" max="20" value="0" />
  </div>
  
  <div class="input-row">
    <label>袋子:</label>
    <select id="bag">
      <option value="none">无</option>
      <option value="small">小袋子</option>
      <option value="medium">中袋子</option>
      <option value="large">大袋子</option>
      <option value="huge">巨大袋子</option>
    </select>
  </div>
  
  <div class="tea-row">
    <label class="tea-label">茶:</label>
    <div class="tea-options">
      <select id="tea1">
        <option value="none">无</option>
        <option value="exp">经验茶</option>
        <option value="efficiency">效率茶</option>
      </select>
      
      <select id="tea2">
        <option value="none">无</option>
        <option value="exp">经验茶</option>
        <option value="efficiency">效率茶</option>
        <option value="extract">汲取茶</option>
      </select>
      
      <select id="tea3">
        <option value="none">无</option>
        <option value="exp">经验茶</option>
        <option value="efficiency">效率茶</option>
        <option value="super_extract">超级汲取茶</option>
      </select>
    </div>
  </div>
  
  <div class="input-row">
    <label>目标等级:</label>
    <input id="target" type="number" min="2" max="200" />
  </div>
  
  <button onclick="calculate()">确认</button>

  <div class="result" id="output"></div>

  <script>
    const expTable = [
      0, 33, 76, 132, 202, 286, 386, 503, 637, 791,
      964, 1159, 1377, 1620, 1891, 2192, 2525, 2893, 3300, 3750,
      4247, 4795, 5400, 6068, 6805, 7618, 8517, 9508, 10604, 11814,
      13151, 14629, 16262, 18068, 20064, 22271, 24712, 27411, 30396, 33697,
      37346, 41381, 45842, 50773, 56222, 62243, 68895, 76242, 84355, 93311,
      103195, 114100, 126127, 139390, 154009, 170118, 187863, 207403, 228914, 252584,
      278623, 307256, 338731, 373318, 411311, 453030, 498824, 549074, 604193, 664632,
      730881, 803472, 882985, 970050, 1065351, 1169633, 1283701, 1408433, 1544780, 1693774,
      1856536, 2034279, 2228321, 2440088, 2671127, 2923113, 3197861, 3497335, 3823663, 4179145,
      4566274, 4987741, 5446463, 5945587, 6488521, 7078945, 7720834, 8418485, 9176537, 10000000,
      11404976, 12904567, 14514400, 16242080, 18095702, 20083886, 22215808, 24501230, 26950540, 29574787,
      32385721, 35395838, 38618420, 42067584, 45758332, 49706603, 53929328, 58444489, 63271179, 68429670,
      73941479, 79829440, 86117783, 92832214, 100000000, 114406130, 130118394, 147319656, 166147618, 186752428,
      209297771, 233962072, 260939787, 290442814, 322702028, 357968938, 396517495, 438646053, 484679494, 534971538,
      589907252, 649905763, 715423218, 786955977, 865044093, 950275074, 1043287971, 1144777804, 1255500373, 1376277458,
      1508002470, 1651646566, 1808265285, 1979005730, 2165114358, 2367945418, 2588970089, 2829786381, 3092129857, 3377885250,
      3689099031, 4027993033, 4396979184, 4798675471, 5235923207, 5711805728, 6229668624, 6793141628, 7406162301, 8073001662,
      8798291902, 9587056372, 10444742007, 11377254401, 12390995728, 13492905745, 14690506120, 15991948361, 17406065609, 18942428633,
      20611406335, 22424231139, 24393069640, 26531098945, 28852589138, 31372992363, 34109039054, 37078841860, 40302007875, 43799759843,
      47595067021, 51712786465, 56179815564, 61025256696, 66280594953, 71979889960, 78159982881, 84860719814, 92125192822, 100000000000
    ];

    // 工具基础行动速度加成
    const toolBonus = {
      'none': 1.0,
      'green': 1.15,
      'emerald': 1.225,
      'platinum': 1.30,
      'copper': 1.45,
      'purple': 1.60,
      'gold': 1.75,
      'azure': 1.90
    };

    // 强化等级加成
    const enhancementBonus = [
      1.0, 1.02, 1.042, 1.066, 1.092, 1.125, 1.15, 1.182, 1.216, 1.25,
      1.29, 1.33, 1.372, 1.416, 1.462, 1.51, 1.56, 1.612, 1.666, 1.722, 1.78
    ];

    // 袋子加成 (假设加成值，可根据实际游戏调整)
    const bagBonus = {
      'none': 1.0,
      'small': 1.05,
      'medium': 1.10,
      'large': 1.15,
      'huge': 1.20
    };

    // 茶的加成
    const teaBonus = {
      'none': { exp: 1.0, efficiency: 1.0 },
      'exp': { exp: 1.12, efficiency: 1.0 },
      'efficiency': { exp: 1.0, efficiency: 1.05 },
      'extract': { exp: 1.0, efficiency: 1.03 },
      'super_extract': { exp: 1.0, efficiency: 1.06 },
      'ultimate_extract': { exp: 1.0, efficiency: 1.09 },
      'collect': { exp: 1.0, efficiency: 1.03 },
      'super_collect': { exp: 1.0, efficiency: 1.06 },
      'ultimate_collect': { exp: 1.0, efficiency: 1.09 }
    };

    // 更新茶选项
    function updateTeaOptions() {
      const profession = document.getElementById('profession').value;
      const tea2 = document.getElementById('tea2');
      const tea3 = document.getElementById('tea3');
      
      // 重置茶选项
      tea2.innerHTML = `
        <option value="none">无</option>
        <option value="exp">经验茶</option>
        <option value="efficiency">效率茶</option>
      `;
      
      tea3.innerHTML = `
        <option value="none">无</option>
        <option value="exp">经验茶</option>
        <option value="efficiency">效率茶</option>
      `;
      
      if (profession === 'extract') {
        tea2.innerHTML += '<option value="extract">汲取茶</option>';
        tea3.innerHTML += '<option value="super_extract">超级汲取茶</option>';
      } else if (profession === 'collect') {
        tea2.innerHTML += '<option value="collect">采集茶</option>';
        tea3.innerHTML += '<option value="super_collect">超级采集茶</option>';
      }
    }

    // 自动设置工具
    function autoSetTool() {
      const level = parseInt(document.getElementById('level').value);
      const toolSelect = document.getElementById('tool');
      
      if (level >= 1 && level <= 9) {
        toolSelect.value = 'green';
      } else if (level >= 10 && level <= 19) {
        toolSelect.value = 'emerald';
      } else if (level >= 20 && level <= 34) {
        toolSelect.value = 'platinum';
      } else if (level >= 35 && level <= 49) {
        toolSelect.value = 'copper';
      } else if (level >= 50 && level <= 64) {
        toolSelect.value = 'purple';
      } else if (level >= 65 && level <= 79) {
        toolSelect.value = 'gold';
      } else if (level >= 80) {
        toolSelect.value = 'azure';
      }
    }

    // 获取目标等级对应的经验值和基础时长
    function getTargetStats(level) {
      let expGain, baseTime;
      
      if (level >= 1 && level <= 9) {
        expGain = 5;
        baseTime = 6;
      } else if (level >= 10 && level <= 19) {
        expGain = 7.5;
        baseTime = 8;
      } else if (level >= 20 && level <= 34) {
        expGain = 12.5;
        baseTime = 11;
      } else if (level >= 35 && level <= 49) {
        expGain = 20;
        baseTime = 14;
      } else if (level >= 50 && level <= 64) {
        expGain = 30;
        baseTime = 17;
      } else if (level >= 65 && level <= 79) {
        expGain = 40;
        baseTime = 20;
      } else if (level >= 80) {
        expGain = 55.5;
        baseTime = 30;
      }
      
      return { expGain, baseTime };
    }

    function secondsToHMS(seconds) {
      const d = Math.floor(seconds);
      if (d < 60) {
        return `${d}秒`;
      } else if (d < 3600) {
        const m = Math.floor(d / 60);
        const s = d % 60;
        return `${m}分钟 ${s}秒`;
      } else if (d < 86400) {
        const h = Math.floor(d / 3600);
        const m = Math.floor((d % 3600) / 60);
        const s = d % 60;
        return `${h}小时 ${m}分钟 ${s}秒`;
      } else {
        const days = Math.floor(d / 86400);
        const h = Math.floor((d % 86400) / 3600);
        const m = Math.floor((d % 3600) / 60);
        const s = d % 60;
        return `${days}天 ${h}小时 ${m}分钟 ${s}秒`;
      }
    }

    function calculate() {
      const currentLevel = parseInt(document.getElementById('level').value);
      const progress = parseFloat(document.getElementById('progress').value);
      const targetLevel = parseInt(document.getElementById('target').value);
      const tool = document.getElementById('tool').value;
      const enhancement = parseInt(document.getElementById('enhancement').value);
      const bag = document.getElementById('bag').value;
      const tea1 = document.getElementById('tea1').value;
      const tea2 = document.getElementById('tea2').value;
      const tea3 = document.getElementById('tea3').value;

      if (currentLevel < 1 || targetLevel > 200 || progress < 0 || progress > 100 || targetLevel <= currentLevel) {
        document.getElementById('output').innerText = "请输入有效数值";
        return;
      }

      // 计算当前经验值
      const expA = expTable[currentLevel - 1];
      const expA1 = expTable[currentLevel];
      const expC = expTable[targetLevel - 1];
      const currentExp = expA + (expA1 - expA) * (progress / 100);
      
      // 需要的经验值
      const neededExp = expC - currentExp;
      
      // 获取目标等级对应的行动数据
      const targetStats = getTargetStats(targetLevel);
      
      // 计算工具和强化加成
      const toolSpeedBonus = toolBonus[tool];
      const enhanceBonus = enhancementBonus[enhancement];
      const bagSpeedBonus = bagBonus[bag];
      
      // 计算茶的加成
      let totalExpBonus = 1.0;
      let totalEfficiencyBonus = 1.0;
      
      [tea1, tea2, tea3].forEach(tea => {
        if (tea !== 'none' && teaBonus[tea]) {
          totalExpBonus *= teaBonus[tea].exp;
          totalEfficiencyBonus *= teaBonus[tea].efficiency;
        }
      });
      
      // 计算实际经验获取
      const actualExpGain = targetStats.expGain * totalExpBonus;
      
      // 计算实际行动时间
      const actualActionTime = targetStats.baseTime / toolSpeedBonus / enhanceBonus / bagSpeedBonus / totalEfficiencyBonus;
      
      // 计算需要的行动次数
      const actionsNeeded = neededExp / actualExpGain;
      
      // 计算总时间
      const totalTime = actionsNeeded * actualActionTime;
      
      const hms = secondsToHMS(totalTime);
      
      document.getElementById('output').innerHTML = `
        需要时间: ${hms}<br>
        需要行动次数: ${Math.ceil(actionsNeeded)}次<br>
        单次行动时间: ${actualActionTime.toFixed(2)}秒<br>
        单次经验获取: ${actualExpGain.toFixed(1)}<br>
        经验加成: ${(totalExpBonus * 100).toFixed(1)}%<br>
        效率加成: ${(totalEfficiencyBonus * 100).toFixed(1)}%
      `;
    }

    // 初始化茶选项
    updateTeaOptions();
  </script>
</body>
</html>
